# Intelligent Traffic Monitoring and Warning System at Dangerous Intersections
# Há»‡ thá»‘ng cáº£nh bÃ¡o, giÃ¡m sÃ¡t giao thÃ´ng thÃ´ng minh táº¡i cÃ¡c Ä‘iá»ƒm giao cáº¯t nguy hiá»ƒm
> âš ï¸ **LÆ°u Ã½**:
> - Repository nÃ y hiá»‡n **khÃ´ng chá»©a mÃ£ nguá»“n** cá»§a há»‡ thá»‘ng do má»™t sá»‘ lÃ½ do liÃªn quan Ä‘áº¿n **báº£o máº­t vÃ  quyá»n riÃªng tÆ° cá»§a cuá»™c thi** náº¿u cÃ³ tháº¯c máº¯c vui lÃ²ng liÃªn há»‡ qua email tungpham010203@gmail.com.
---


# ThÃ nh tÃ­ch - CÃ¡c bÃ i bÃ¡o

- ğŸ¥‰ **Giáº£i Ba cáº¥p Quá»‘c gia** Cuá»™c thi Khoa há»c ká»¹ thuáº­t há»c sinh trung há»c nÄƒm há»c 2021-2022  

  **Link:**
  - [BÃ¡o Ninh BÃ¬nh](https://baoninhbinh.org.vn/hai-nam-sinh-truong-thpt-hoa-lu-a-voi-giai-ba-quoc-gia-ve-sang-kien-canh-bao-giao-thong-thong-minh/d20220607082731436.htm)
  - [ÄÃ i NBTV](https://nbtv.vn/news/401/48578/du-an-cua-hoc-sinh-truong-thpt-hoa-lu-a-dat-giai-ba-cuoc-thi-khoa-hoc-ky-thuat-quoc-gia)
  - [BÃ¡o Ninh BÃ¬nh](https://baoninhbinh.org.vn/ninh-binh-co-2-du-an-dat-giai-ba-cuoc-thi-nghien-cuu-khkt/d2022032722111733.htm)
  - [Tuyensinh247](https://tuyensinh247.com/bai-tap-560791.html)
  - [BÃ¡o NBTV](https://nbtv.vn/news/401/26640/sang-kien-huu-ich-dam-bao-atgt-tai-diem-giao-cat-nguy-hiem)

- ğŸ¥‡ **Giáº£i Nháº¥t cáº¥p tá»‰nh Ninh BÃ¬nh** Cuá»™c thi Khoa há»c ká»¹ thuáº­t há»c sinh trung há»c nÄƒm há»c 2021-2022

  **Link:**
  - [BÃ¡o PhÃ²ng GD&ÄT TP Ninh BÃ¬nh](https://ninhbinh.edu.vn/pgdtpninhbinh/cong-van-van-ban/van-ban-phong-gd-dt/thong-bao-ket-qua-cuoc-thi-khoa-hoc-ky-thuat-danh-cho-hoc-si4.html)
  - [BÃ¡o DÃ¢n Sinh](https://dansinh.dantri.com.vn/dien-dan-dan-sinh/68-du-an-doat-giai-khoa-hoc-ki-thuat-tinh-ninh-binh-20220102224339000.htm)


## Giá»›i thiá»‡u

- Dá»± Ã¡n nháº±m giáº£i quyáº¿t váº¥n Ä‘á» tai náº¡n giao thÃ´ng táº¡i cÃ¡c Ä‘iá»ƒm giao cáº¯t nguy hiá»ƒm (bá»‹ che khuáº¥t, táº§m nhÃ¬n háº¡n cháº¿), báº±ng cÃ¡ch xÃ¢y dá»±ng má»™t há»‡ thá»‘ng cáº£nh bÃ¡o, giÃ¡m sÃ¡t thÃ´ng minh, tá»± Ä‘á»™ng phÃ¡t hiá»‡n phÆ°Æ¡ng tiá»‡n Ä‘i tá»›i Ä‘iá»ƒm giao cáº¯t Ä‘á»ƒ Ä‘Æ°a ra cáº£nh bÃ¡o cho cÃ¡c phÆ°Æ¡ng tiá»‡n tá»« hÆ°á»›ng khÃ¡c **Ráº±ng:** cÃ³ phÆ°Æ¡ng tiá»‡n Ä‘ang Ä‘i tá»›i Ä‘iá»ƒu giao cáº¯t.
- Äiá»ƒm giao cáº¯t á»Ÿ Ä‘Ã¢y lÃ  Ä‘iá»ƒm giao cáº¯t cÃ³ máº­t Ä‘á»™ phÆ°Æ¡ng tiá»‡n tháº¥p chÆ°a cáº§n dÃ¹ng Ä‘Ã¨n gia thÃ´ng (xanh-vÃ ng_Ä‘á»).
- VÃ  tÃ­nh toÃ¡n tá»‘c Ä‘á»™, cáº£nh bÃ¡o vÃ  chá»¥p áº£nh xe vi pháº¡m.


# Chi tiáº¿t vá» cÃ´ng nghá»‡ sá»­ dá»¥ng trong há»‡ thá»‘ng cá»§a dá»± Ã¡n:

## Pháº§n má»m

### 1. Python/OpenCV
- **MÃ´ táº£**: Ná»n táº£ng xá»­ lÃ½ hÃ¬nh áº£nh vÃ  phÃ¡t hiá»‡n Ä‘á»‘i tÆ°á»£ng chÃ­nh cá»§a há»‡ thá»‘ng.
- **ThÃ nh pháº§n vÃ  tÃ­nh nÄƒng**:
  - **OpenCV**: ThÆ° viá»‡n Computer Vision mÃ£ nguá»“n má»Ÿ
    - Há»— trá»£ thuáº­t toÃ¡n trá»« ná»n (BackgroundSubtractorMOG)
    - Cung cáº¥p cÃ¡c hÃ m xá»­ lÃ½ hÃ¬nh áº£nh nhÆ° threshold, morphologyEx, erode
    - Há»— trá»£ tÃ¬m vÃ  xá»­ lÃ½ Ä‘Æ°á»ng viá»n (contours)
    - Váº½ hÃ¬nh chá»¯ nháº­t, Ä‘Æ°á»ng tháº³ng Ä‘á»ƒ Ä‘Ã¡nh dáº¥u Ä‘á»‘i tÆ°á»£ng vÃ  vÃ¹ng tÃ­nh toÃ¡n
  
  - **Láº¥y dá»¯ liá»‡u tá»« camera**:
    ```python
    # Äá»c video tá»« camera IP
    cap = cv2.VideoCapture('rtsp://admin:abcd1234@192.168.0.109/8000', cv2.CAP_FFMPEG)
    ```

### 2. Firebase
- **MÃ´ táº£**: Ná»n táº£ng Ä‘Ã¡m mÃ¢y Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u vÃ  hÃ¬nh áº£nh vi pháº¡m.
- **ThÃ nh pháº§n vÃ  tÃ­nh nÄƒng**:
  - **Realtime Database**: CÆ¡ sá»Ÿ dá»¯ liá»‡u thá»i gian thá»±c Ä‘á»ƒ lÆ°u thÃ´ng tin vi pháº¡m
  - **Cloud Storage**: LÆ°u trá»¯ hÃ¬nh áº£nh phÆ°Æ¡ng tiá»‡n vi pháº¡m tá»‘c Ä‘á»™
  - **Káº¿t ná»‘i thÃ´ng qua thÆ° viá»‡n Pyrebase**:


### 3. Arduino IDE (C/C++)
- **MÃ´ táº£**: Pháº§n má»m láº­p trÃ¬nh cho vi Ä‘iá»u khiá»ƒn Arduino Ä‘á»ƒ Ä‘iá»u khiá»ƒn há»‡ thá»‘ng cáº£nh bÃ¡o váº­t lÃ½.
- **ThÃ nh pháº§n vÃ  tÃ­nh nÄƒng**:
  - **Giao tiáº¿p Serial**: Nháº­n dá»¯ liá»‡u tá»« Mini PC qua cá»•ng COM
    ```python
    # Káº¿t ná»‘i vá»›i Arduino qua cá»•ng COM6, tá»‘c Ä‘á»™ 115200 baud
    ser = serial.Serial('COM6', 115200, timeout=0)
    
    # Gá»­i dá»¯ liá»‡u tá»‘c Ä‘á»™ tá»›i Arduino
    send_vt = str(vantoc) + '\n'
    ser.write(bytes(send_vt, 'utf-8'))
    ```
  
  - **Äiá»u khiá»ƒn Ä‘Ã¨n cáº£nh bÃ¡o**: Dá»±a trÃªn dá»¯ liá»‡u tá»‘c Ä‘á»™ nháº­n Ä‘Æ°á»£c tá»« Mini PC
    - KÃ­ch hoáº¡t Ä‘Ã¨n bÃ¡o khi phÃ¡t hiá»‡n phÆ°Æ¡ng tiá»‡n Ä‘ang tiáº¿n Ä‘áº¿n Ä‘iá»ƒm giao cáº¯t
    - Thay Ä‘á»•i má»©c Ä‘á»™ cáº£nh bÃ¡o (táº§n sá»‘ nháº¥p nhÃ¡y, cÆ°á»ng Ä‘á»™) dá»±a trÃªn tá»‘c Ä‘á»™ cá»§a phÆ°Æ¡ng tiá»‡n
    - Táº¯t Ä‘Ã¨n cáº£nh bÃ¡o sau má»™t khoáº£ng thá»i gian nháº¥t Ä‘á»‹nh hoáº·c khi phÆ°Æ¡ng tiá»‡n Ä‘Ã£ Ä‘i qua Ä‘iá»ƒm giao cáº¯t
  
  - **Äiá»u khiá»ƒn cÃ²i cáº£nh bÃ¡o**: KÃ­ch hoáº¡t Ã¢m thanh cáº£nh bÃ¡o khi cáº§n thiáº¿t (cÃ³ phÆ°Æ¡ng tiá»‡n Ä‘i vá»›i tá»‘c Ä‘á»™ cao tá»›i giao cáº¯t)
    - Äiá»u chá»‰nh thá»i gian cáº£nh bÃ¡o phÃ¹ há»£p vá»›i tÃ¬nh huá»‘ng giao thÃ´ng

## Pháº§n cá»©ng

### 1. Camera Hikvision
- **MÃ´ táº£**: Camera IP cÃ´ng nghiá»‡p Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ giÃ¡m sÃ¡t Ä‘iá»ƒm giao cáº¯t. 
- **Äáº·c Ä‘iá»ƒm ká»¹ thuáº­t**:
  - Äá»™ phÃ¢n giáº£i cao, há»— trá»£ ghi hÃ¬nh cáº£ ngÃ y láº«n Ä‘Ãªm
  - ÄÆ°á»£c káº¿t ná»‘i qua giao thá»©c RTSP (Real Time Streaming Protocol): `rtsp://admin:abcd1234@192.168.0.109/8000`
  - GÃ³c nhÃ¬n rá»™ng Ä‘á»ƒ bao quÃ¡t toÃ n bá»™ Ä‘iá»ƒm giao cáº¯t
  - Kháº£ nÄƒng chá»‹u Ä‘iá»u kiá»‡n thá»i tiáº¿t khÃ¡c nhau khi láº¯p Ä‘áº·t ngoÃ i trá»i
  - Há»— trá»£ nÃ©n video H.264/H.265 giÃºp giáº£m bÄƒng thÃ´ng khi truyá»n dá»¯ liá»‡u

### 2. Mini PC ASUS
- **MÃ´ táº£**: MÃ¡y tÃ­nh nhá» gá»n, tiáº¿t kiá»‡m nÄƒng lÆ°á»£ng Ä‘áº£m nhiá»‡m vai trÃ² xá»­ lÃ½ hÃ¬nh áº£nh vÃ  cháº¡y thuáº­t toÃ¡n phÃ¡t hiá»‡n phÆ°Æ¡ng tiá»‡n.
- **Cáº¥u hÃ¬nh**:
  - CPU Ä‘á»§ máº¡nh Ä‘á»ƒ xá»­ lÃ½ thuáº­t toÃ¡n trá»« ná»n vÃ  theo dÃµi Ä‘á»‘i tÆ°á»£ng thá»i gian thá»±c
  - RAM tá»‘i thiá»ƒu 4GB Ä‘á»ƒ Ä‘áº£m báº£o xá»­ lÃ½ video mÆ°á»£t mÃ 
  - Káº¿t ná»‘i máº¡ng LAN/WiFi Ä‘á»ƒ nháº­n dá»¯ liá»‡u tá»« camera vÃ  truyá»n lÃªn Firebase
  - Cá»•ng COM/USB Ä‘á»ƒ giao tiáº¿p vá»›i Arduino
  - Há»‡ Ä‘iá»u hÃ nh Windows

### 3. Arduino Mega 2560
- **MÃ´ táº£**: Vi Ä‘iá»u khiá»ƒn Ä‘Ã³ng vai trÃ² trung gian giá»¯a pháº§n má»m xá»­ lÃ½ hÃ¬nh áº£nh vÃ  há»‡ thá»‘ng cáº£nh bÃ¡o váº­t lÃ½.
- **Äáº·c Ä‘iá»ƒm ká»¹ thuáº­t**:
  - Microcontroller ATmega2560
  - 54 chÃ¢n I/O sá»‘ (trong Ä‘Ã³ 15 chÃ¢n cÃ³ thá»ƒ xuáº¥t xung PWM)
  - 16 chÃ¢n Ä‘áº§u vÃ o analog
  - 4 UART (cá»•ng ná»‘i tiáº¿p pháº§n cá»©ng)
  - Tá»‘c Ä‘á»™ xung nhá»‹p 16 MHz
  - Káº¿t ná»‘i vá»›i Mini PC qua cá»•ng COM6 vá»›i tá»‘c Ä‘á»™ baud 115200
  - Chá»‹u trÃ¡ch nhiá»‡m Ä‘iá»u khiá»ƒn Ä‘Ã¨n cáº£nh bÃ¡o vÃ  cÃ²i thÃ´ng qua module relay

### 4. Module Relay 16 kÃªnh
- **MÃ´ táº£**: Máº¡ch chuyá»ƒn máº¡ch Ä‘iá»‡n Ä‘á»ƒ Ä‘iá»u khiá»ƒn cÃ¡c thiáº¿t bá»‹ cáº£nh bÃ¡o cÃ´ng suáº¥t lá»›n.
- **Äáº·c Ä‘iá»ƒm ká»¹ thuáº­t**:
  - 16 kÃªnh relay Ä‘á»™c láº­p
  - Äiá»‡n Ã¡p Ä‘iá»u khiá»ƒn 5V (tÆ°Æ¡ng thÃ­ch vá»›i Arduino)
  - NgÃµ ra tiáº¿p Ä‘iá»ƒm thÆ°á»ng má»Ÿ (NO) vÃ  thÆ°á»ng Ä‘Ã³ng (NC)
  - Kháº£ nÄƒng chá»‹u táº£i 10A/250VAC hoáº·c 10A/30VDC
  - ÄÃ¨n LED bÃ¡o tráº¡ng thÃ¡i cho má»—i kÃªnh
  - KÃ­ch hoáº¡t má»©c logic tháº¥p (active low)

### 5. ÄÃ¨n LED cáº£nh bÃ¡o
- **MÃ´ táº£**: Há»‡ thá»‘ng Ä‘Ã¨n cáº£nh bÃ¡o Ä‘Æ°á»£c láº¯p Ä‘áº·t táº¡i Ä‘iá»ƒm giao cáº¯t Ä‘á»ƒ thÃ´ng bÃ¡o cho ngÆ°á»i tham gia giao thÃ´ng.
- **Äáº·c Ä‘iá»ƒm ká»¹ thuáº­t**:
  - ÄÃ¨n LED cÃ´ng suáº¥t lá»›n, Ã¡nh sÃ¡ng máº¡nh, dá»… nháº­n biáº¿t trong nhiá»u Ä‘iá»u kiá»‡n thá»i tiáº¿t
  - CÃ³ thá»ƒ nháº¥p nhÃ¡y vá»›i táº§n sá»‘ khÃ¡c nhau tÃ¹y vÃ o má»©c Ä‘á»™ cáº£nh bÃ¡o
  - MÃ u sáº¯c khÃ¡c nhau cho cÃ¡c má»©c Ä‘á»™ cáº£nh bÃ¡o (vÃ ng cho cáº£nh bÃ¡o thÃ´ng thÆ°á»ng, Ä‘á» cho cáº£nh bÃ¡o kháº©n cáº¥p)
  - ÄÆ°á»£c Ä‘iá»u khiá»ƒn qua module relay tá»« Arduino

## TÃ­ch há»£p há»‡ thá»‘ng

- **Luá»“ng dá»¯ liá»‡u**:
  1. Camera ghi hÃ¬nh Ä‘iá»ƒm giao cáº¯t vÃ  truyá»n video theo thá»i gian thá»±c tá»›i Mini PC
  2. Mini PC xá»­ lÃ½ video Ä‘á»ƒ phÃ¡t hiá»‡n phÆ°Æ¡ng tiá»‡n vÃ  tÃ­nh toÃ¡n tá»‘c Ä‘á»™
  3. Khi phÃ¡t hiá»‡n phÆ°Æ¡ng tiá»‡n, Mini PC gá»­i thÃ´ng tin tá»›i Arduino qua cá»•ng COM
  4. Arduino Ä‘iá»u khiá»ƒn Ä‘Ã¨n vÃ  cÃ²i cáº£nh bÃ¡o thÃ´ng qua Module Relay
  5. Náº¿u phÃ¡t hiá»‡n phÆ°Æ¡ng tiá»‡n vi pháº¡m tá»‘c Ä‘á»™, hÃ¬nh áº£nh Ä‘Æ°á»£c lÆ°u vÃ o bá»™ nhá»› vÃ  táº£i lÃªn Firebase

- **Váº­n hÃ nh tá»± Ä‘á»™ng**:
  - Há»‡ thá»‘ng hoáº¡t Ä‘á»™ng liÃªn tá»¥c vÃ  tá»± Ä‘á»™ng 24/7
  - Tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh má»©c Ä‘á»™ cáº£nh bÃ¡o dá»±a trÃªn tÃ¬nh huá»‘ng giao thÃ´ng
  - Ghi nháº­n vi pháº¡m vÃ  lÆ°u trá»¯ dá»¯ liá»‡u khÃ´ng cáº§n sá»± can thiá»‡p cá»§a con ngÆ°á»i

- **Tiáº¿t kiá»‡m nÄƒng lÆ°á»£ng**:
  - Há»‡ thá»‘ng chá»‰ kÃ­ch hoáº¡t cáº£nh bÃ¡o khi phÃ¡t hiá»‡n phÆ°Æ¡ng tiá»‡n
  - ÄÃ¨n vÃ  cÃ²i cáº£nh bÃ¡o Ä‘Æ°á»£c táº¯t sau khi phÆ°Æ¡ng tiá»‡n Ä‘Ã£ Ä‘i qua Ä‘iá»ƒm giao cáº¯t
  - Sá»­ dá»¥ng Mini PC vÃ  Arduino cÃ³ má»©c tiÃªu thá»¥ Ä‘iá»‡n nÄƒng tháº¥p


## Chi tiáº¿t vá» thuáº­t toÃ¡n phÃ¡t hiá»‡n phÆ°Æ¡ng tiá»‡n táº¡i Ä‘iá»ƒm giao cáº¯t


### 1. NguyÃªn lÃ½ hoáº¡t Ä‘á»™ng tá»•ng quÃ¡t

Há»‡ thá»‘ng sá»­ dá»¥ng ká»¹ thuáº­t **trá»« ná»n (background subtraction)** káº¿t há»£p vá»›i **theo dÃµi Ä‘á»‘i tÆ°á»£ng (object tracking)** Ä‘á»ƒ phÃ¡t hiá»‡n vÃ  giÃ¡m sÃ¡t phÆ°Æ¡ng tiá»‡n tiáº¿p cáº­n Ä‘iá»ƒm giao cáº¯t. QuÃ¡ trÃ¬nh nÃ y gá»“m cÃ¡c bÆ°á»›c chÃ­nh:

1. Trá»« ná»n Ä‘á»ƒ tÃ¡ch phÆ°Æ¡ng tiá»‡n di chuyá»ƒn khá»i ná»n cá»‘ Ä‘á»‹nh
2. XÃ¡c Ä‘á»‹nh vÃ  Ä‘Ã¡nh dáº¥u Ä‘á»‘i tÆ°á»£ng di chuyá»ƒn
3. Theo dÃµi Ä‘á»‘i tÆ°á»£ng qua cÃ¡c khung hÃ¬nh liÃªn tiáº¿p
4. GÃ¡n ID vÃ  tÃ­nh toÃ¡n cÃ¡c thÃ´ng sá»‘ (tá»‘c Ä‘á»™, vá»‹ trÃ­)

### 2. PhÃ¡t hiá»‡n chuyá»ƒn Ä‘á»™ng báº±ng trá»« ná»n

Sá»­ dá»¥ng cÃ¡c thuáº­t toÃ¡n trá»« ná»n tá»« OpenCV:

Thuáº­t toÃ¡n MOG (Mixture Of Gaussians) táº¡o ra mÃ´ hÃ¬nh ná»n dá»±a trÃªn sá»± phÃ¢n phá»‘i Gaussian. Khi cÃ³ Ä‘á»‘i tÆ°á»£ng di chuyá»ƒn, pixel táº¡i vá»‹ trÃ­ Ä‘Ã³ sáº½ khÃ¡c biá»‡t so vá»›i mÃ´ hÃ¬nh ná»n, táº¡o ra "máº·t náº¡" (mask) chá»‰ ra cÃ¡c khu vá»±c cÃ³ chuyá»ƒn Ä‘á»™ng.

```python
fgmask = fgbg.apply(frame)  # Ãp dá»¥ng trá»« ná»n Ä‘á»ƒ táº¡o máº·t náº¡ chuyá»ƒn Ä‘á»™ng
ret, imBin = cv2.threshold(fgmask, 100, 255, cv2.THRESH_BINARY)  # PhÃ¢n ngÆ°á»¡ng Ä‘á»ƒ cÃ³ hÃ¬nh áº£nh nhá»‹ phÃ¢n
```

### 3. Xá»­ lÃ½ hÃ¬nh áº£nh Ä‘á»ƒ loáº¡i bá» nhiá»…u

Sau khi cÃ³ máº·t náº¡ nhá»‹ phÃ¢n, há»‡ thá»‘ng Ã¡p dá»¥ng cÃ¡c ká»¹ thuáº­t hÃ¬nh thÃ¡i há»c Ä‘á»ƒ lá»c nhiá»…u vÃ  cáº£i thiá»‡n cháº¥t lÆ°á»£ng phÃ¡t hiá»‡n:

```python
# Xá»­ lÃ½ hÃ¬nh thÃ¡i há»c Ä‘á»ƒ cáº£i thiá»‡n cháº¥t lÆ°á»£ng phÃ¡t hiá»‡n
mask1 = cv2.morphologyEx(imBin, cv2.MORPH_OPEN, kernalOp)  # Má»Ÿ - loáº¡i bá» Ä‘iá»ƒm nhiá»…u nhá»
mask2 = cv2.morphologyEx(mask1, cv2.MORPH_CLOSE, kernalCl)  # ÄÃ³ng - lÃ m Ä‘áº§y cÃ¡c lá»— há»•ng nhá»
e_img = cv2.erode(mask2, kernal_e)  # XÃ³i mÃ²n - lÃ m má»ng cÃ¡c Ä‘Æ°á»ng viá»n
```

- **MORPH_OPEN**: Loáº¡i bá» cÃ¡c cháº¥m nhiá»…u nhá» khá»i máº·t náº¡
- **MORPH_CLOSE**: LÃ m Ä‘áº§y cÃ¡c lá»— há»•ng nhá» trong Ä‘á»‘i tÆ°á»£ng
- **Erode**: LÃ m má»ng Ä‘Æ°á»ng viá»n cÃ¡c Ä‘á»‘i tÆ°á»£ng

### 4. TÃ¬m Ä‘Æ°á»ng viá»n vÃ  xÃ¡c Ä‘á»‹nh phÆ°Æ¡ng tiá»‡n

Sau khi cÃ³ máº·t náº¡ Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½, há»‡ thá»‘ng tÃ¬m cÃ¡c Ä‘Æ°á»ng viá»n (contours) - Ä‘Ã¢y lÃ  cÃ¡c vÃ¹ng liÃªn tá»¥c Ä‘áº¡i diá»‡n cho cÃ¡c Ä‘á»‘i tÆ°á»£ng:

```python
contours, _ = cv2.findContours(e_img, cv2.RETR_TREE, cv2.CHAIN_APPROX_SIMPLE)
```

Há»‡ thá»‘ng lá»c cÃ¡c Ä‘Æ°á»ng viá»n dá»±a trÃªn diá»‡n tÃ­ch Ä‘á»ƒ trÃ¡nh phÃ¡t hiá»‡n cÃ¡c váº­t thá»ƒ quÃ¡ nhá»:

```python
detections = []
for cnt in contours:
    area = cv2.contourArea(cnt)
    if area > 1400:  # Chá»‰ xÃ©t cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ diá»‡n tÃ­ch > 1400 pixel
        x, y, w, h = cv2.boundingRect(cnt)  # TÃ­nh hÃ¬nh chá»¯ nháº­t bao quanh Ä‘á»‘i tÆ°á»£ng
        if w > 4:  # Äáº£m báº£o chiá»u rá»™ng Ä‘á»§ lá»›n
            cv2.rectangle(frame, (x, y), (x+w, y+h), (0, 255, 0), 3)  # Váº½ hÃ¬nh chá»¯ nháº­t
            detections.append([x, y, w, h])  # ThÃªm vÃ o danh sÃ¡ch phÃ¡t hiá»‡n
```

### 5. Theo dÃµi Ä‘á»‘i tÆ°á»£ng vÃ  gÃ¡n ID

#### Báº¯t Ä‘áº§u theo dÃµi Ä‘á»‘i tÆ°á»£ng qua cÃ¡c frame. NguyÃªn lÃ½ hoáº¡t Ä‘á»™ng:

Má»—i khi phÃ¡t hiá»‡n Ä‘Æ°á»£c Ä‘á»‘i tÆ°á»£ng má»›i, há»‡ thá»‘ng sáº½:
1. Cáº­p nháº­t vá»‹ trÃ­ cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Ã£ Ä‘Æ°á»£c theo dÃµi
2. GÃ¡n ID má»›i cho Ä‘á»‘i tÆ°á»£ng chÆ°a Ä‘Æ°á»£c theo dÃµi
3. Duy trÃ¬ danh sÃ¡ch cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘ang trong vÃ¹ng giÃ¡m sÃ¡t

### 6. XÃ¡c Ä‘á»‹nh vá»‹ trÃ­ vÃ  tÃ­nh toÃ¡n tá»‘c Ä‘á»™

Há»‡ thá»‘ng sá»­ dá»¥ng hai Ä‘Æ°á»ng káº» ngang trÃªn khung hÃ¬nh Ä‘á»ƒ tÃ­nh thá»i gian di chuyá»ƒn cá»§a phÆ°Æ¡ng tiá»‡n:

```python
# Váº½ hai Ä‘Æ°á»ng tham chiáº¿u Ä‘á»ƒ tÃ­nh tá»‘c Ä‘á»™
cv2.line(frame, (0, 220), (4600, 220), (0, 0, 255), 2)  # ÄÆ°á»ng tham chiáº¿u 1
cv2.line(frame, (0, 165), (4600, 165), (0, 0, 255), 2)  # ÄÆ°á»ng tham chiáº¿u 2
```

Khi phÆ°Æ¡ng tiá»‡n Ä‘i qua Ä‘Æ°á»ng tham chiáº¿u thá»© nháº¥t (y=220), há»‡ thá»‘ng báº¯t Ä‘áº§u Ä‘áº¿m thá»i gian. Khi phÆ°Æ¡ng tiá»‡n Ä‘i qua Ä‘Æ°á»ng tham chiáº¿u thá»© hai (y=165), há»‡ thá»‘ng dá»«ng Ä‘áº¿m thá»i gian vÃ  tÃ­nh tá»‘c Ä‘á»™:

```python
def getSpeed(self, id):
    if (self.s[0, id] > 0):
        s = (0.83 / self.s[0, id]) * 3.6  # km/h - 0.83 lÃ  khoáº£ng cÃ¡ch thá»±c táº¿ giá»¯a hai Ä‘Æ°á»ng (m)
    else:
        s = 0
    return int(s)
```

### 7. Cáº£nh bÃ¡o vÃ  ghi nháº­n vi pháº¡m
- Náº¿u tá»‘c Ä‘á»™ vÆ°á»£t quÃ¡ giá»›i háº¡n, há»‡ thá»‘ng sáº½ Ä‘Ã¡nh dáº¥u phÆ°Æ¡ng tiá»‡n báº±ng mÃ u khÃ¡c vÃ  chá»¥p áº£nh lÆ°u láº¡i.


## TiÃªu chÃ­ cá»§a há»‡ thá»‘ng:
- Tá»± Ä‘á»™ng phÃ¡t hiá»‡n phÆ°Æ¡ng tiá»‡n Ä‘i tá»›i Ä‘iá»ƒm giao cáº¯t Ä‘á»ƒ Ä‘Æ°a ra cáº£nh bÃ¡o cho cÃ¡c phÆ°Æ¡ng tiá»‡n tá»« hÆ°á»›ng khÃ¡c **Ráº±ng:** cÃ³ phÆ°Æ¡ng tiá»‡n Ä‘ang Ä‘i tá»›i Ä‘iá»ƒu giao cáº¯t. (Äiá»ƒm giao cáº¯t á»Ÿ Ä‘Ã¢y lÃ  Ä‘iá»ƒm giao cáº¯t cÃ³ máº­t Ä‘á»™ phÆ°Æ¡ng tiá»‡n tháº¥p chÆ°a cáº§n dÃ¹ng Ä‘Ã¨n gia thÃ´ng (xanh-vÃ ng_Ä‘á»))

- GiÃ¡m sÃ¡t báº±ng cÃ¡ch Æ°á»›c tÃ­nh tá»‘c Ä‘á»™, chá»¥p hÃ¬nh phÆ°Æ¡ng tiá»‡n Ä‘i tá»›i Ä‘iá»ƒm giao cáº¯t vá»›i tá»‘c Ä‘á»™ cao khoáº£ng (60 km/h) Ä‘Ã¢y lÃ  tá»‘c Ä‘á»™ há»‡ thá»‘ng Ä‘ang Ä‘áº·t, cÃ³ thá»ƒ tuá»³ chá»‰nh.

## TÃ­nh nÄƒng chÃ­nh

* **PhÃ¡t hiá»‡n phÆ°Æ¡ng tiá»‡n á»Ÿ cÃ¡c hÆ°á»›ng Ä‘áº¿n Ä‘iá»ƒm giao cáº¯t**:
  Sá»­ dá»¥ng thuáº­t toÃ¡n so sÃ¡nh chuyá»ƒn Ä‘á»™ng giá»¯a 2 frame liÃªn tiáº¿p Ä‘á»ƒ phÃ¡t hiá»‡n sá»± thay Ä‘á»•i vá»‹ trÃ­ cá»§a váº­t thá»ƒ. Má»—i phÆ°Æ¡ng tiá»‡n Ä‘Æ°á»£c Ä‘Ã¡nh sá»‘ ID riÃªng biá»‡t Ä‘á»ƒ theo dÃµi trong toÃ n bá»™ quÃ¡ trÃ¬nh di chuyá»ƒn.

* **TÃ­nh toÃ¡n tá»‘c Ä‘á»™ phÆ°Æ¡ng tiá»‡n**:

  * Váº½ hai Ä‘Æ°á»ng káº» ngang cá»‘ Ä‘á»‹nh trÃªn khung hÃ¬nh (Ä‘Æ°á»ng 1 vÃ  Ä‘Æ°á»ng 2) tÆ°Æ¡ng á»©ng vá»›i má»™t Ä‘oáº¡n Ä‘Æ°á»ng cÃ³ Ä‘á»™ dÃ i thá»±c táº¿ $s$ (Ä‘Æ¡n vá»‹ mÃ©t).
  * Khi má»™t phÆ°Æ¡ng tiá»‡n di chuyá»ƒn tá»« Ä‘Æ°á»ng káº» 1 Ä‘áº¿n Ä‘Æ°á»ng káº» 2, há»‡ thá»‘ng ghi láº¡i thá»i gian $t$ (giÃ¢y) mÃ  phÆ°Æ¡ng tiá»‡n Ä‘i qua Ä‘oáº¡n Ä‘Æ°á»ng nÃ y.
  * Ãp dá»¥ng cÃ´ng thá»©c váº­t lÃ½: v = s\t Ä‘á»ƒ tÃ­nh tá»‘c Ä‘á»™ gáº§n Ä‘Ãºng cá»§a phÆ°Æ¡ng tiá»‡n. (phá»¥c vá»¥ Ä‘á»ƒ tÃ­nh thá»i gian táº¯t Ä‘Ã¨n cáº£nh bÃ¡o khi xe Ä‘Ã£ qua Ä‘iá»ƒm giao cáº¯t vÃ  xá»­ pháº¡t tá»‘c Ä‘á»™ cao)

* **Cáº£nh bÃ¡o vÃ  giÃ¡m sÃ¡t thÃ´ng minh**:

  * PhÃ¡t cáº£nh bÃ¡o báº±ng Ä‘Ã¨n vÃ  cÃ²i khi phÃ¡t hiá»‡n phÆ°Æ¡ng tiá»‡n Ä‘ang tiáº¿n Ä‘áº¿n Ä‘iá»ƒm giao cáº¯t nguy hiá»ƒm.
  * Náº¿u phÆ°Æ¡ng tiá»‡n vÆ°á»£t quÃ¡ tá»‘c Ä‘á»™ cho phÃ©p, há»‡ thá»‘ng sáº½:

    * KÃ­ch hoáº¡t cáº£nh bÃ¡o nÃ¢ng cao (Ä‘Ã¨n/cÃ²i máº¡nh hÆ¡n).
    * Tá»± Ä‘á»™ng chá»¥p áº£nh phÆ°Æ¡ng tiá»‡n vi pháº¡m.
    * Gá»­i áº£nh vÃ  dá»¯ liá»‡u vi pháº¡m thá»i gian thá»±c lÃªn **Firebase** Ä‘á»ƒ lÆ°u trá»¯ vÃ  há»— trá»£ giÃ¡m sÃ¡t tá»« xa.


## Káº¿t quáº£ thá»­ nghiá»‡m

- Há»‡ thá»‘ng hoáº¡t Ä‘á»™ng tá»‘t trong nhiá»u ká»‹ch báº£n: xe vÆ°á»£t tá»‘c Ä‘á»™, nhiá»u hÆ°á»›ng giao thÃ´ng.
- Cáº£nh bÃ¡o rÃµ rÃ ng, chÃ­nh xÃ¡c; ghi láº¡i hÃ¬nh áº£nh phÆ°Æ¡ng tiÃªn.

### Æ¯u Ä‘iá»ƒm cá»§a phÆ°Æ¡ng phÃ¡p nÃ y

1. **ÄÆ¡n giáº£n vÃ  hiá»‡u quáº£**: Sá»­ dá»¥ng thuáº­t toÃ¡n trá»« ná»n tiÃªu chuáº©n tá»« OpenCV
2. **XÃ¡c Ä‘á»‹nh Ä‘á»™c láº­p tá»«ng phÆ°Æ¡ng tiá»‡n**: Má»—i phÆ°Æ¡ng tiá»‡n Ä‘Æ°á»£c Ä‘Ã¡nh ID riÃªng biá»‡t
3. **Ãt tÃ i nguyÃªn**: KhÃ´ng yÃªu cáº§u GPU hay pháº§n cá»©ng máº¡nh
4. **TÃ­nh toÃ¡n tá»‘c Ä‘á»™ thá»±c táº¿**: Dá»±a trÃªn thá»i gian di chuyá»ƒn qua khoáº£ng cÃ¡ch Ä‘Ã£ biáº¿t
5. **TÃ­ch há»£p vá»›i há»‡ thá»‘ng cáº£nh bÃ¡o**: Gá»­i dá»¯ liá»‡u qua Arduino Ä‘á»ƒ kÃ­ch hoáº¡t cáº£nh bÃ¡o

### Háº¡n cháº¿

1. **Nháº¡y cáº£m vá»›i thay Ä‘á»•i Ã¡nh sÃ¡ng**: Thuáº­t toÃ¡n trá»« ná»n cÃ³ thá»ƒ bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi Ä‘iá»u kiá»‡n Ã¡nh sÃ¡ng
2. **Chá»“ng láº¥p Ä‘á»‘i tÆ°á»£ng**: KhÃ³ phÃ¢n biá»‡t khi nhiá»u phÆ°Æ¡ng tiá»‡n chá»“ng láº¥p nhau
3. **Äiá»u kiá»‡n thá»i tiáº¿t**: Hiá»‡u suáº¥t cÃ³ thá»ƒ giáº£m trong Ä‘iá»u kiá»‡n mÆ°a, tuyáº¿t, sÆ°Æ¡ng mÃ¹
4. **GÃ³c camera**: Phá»¥ thuá»™c nhiá»u vÃ o vá»‹ trÃ­ Ä‘áº·t camera


## Má»™t sá»‘ hÃ¬nh áº£nh thá»­ nghiá»‡m trÃªn camera Ä‘Æ°á»£c láº¯p trÆ°á»›c Ä‘iá»ƒm giao cáº¯t trÆ°á»›c cá»•ng trÆ°á»ng há»c:
#### Do cÃ¡c hÃ¬nh áº£nh vÃ  video lÆ°u trá»¯ Ä‘Ã£ lÃ¢u nÃªn cháº¥t lÆ°á»£ng hÃ¬nh áº£nh cÃ³ thá»ƒ Ä‘Ã£ bá»‹ giáº£m

<p align="center">
  <img src="https://github.com/user-attachments/assets/56e60d84-c97f-4281-8da5-cf9b29b8811b" width="45%">
  <img src="https://github.com/user-attachments/assets/9f560e7e-b493-4b10-b923-756669f81327" width="45%">
</p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/9da2bc39-e984-4f9a-9381-1a49da8fd1a7" width="45%">
  <img src="https://github.com/user-attachments/assets/eb8139f8-5b63-4cb1-9288-5ab9569a2c5c" width="45%">
</p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/72c7f747-afbc-4d73-974b-f1d5e0d20081" width="45%">
  <img src="https://github.com/user-attachments/assets/b886621e-18ba-4149-8c62-8d569e2398ef" width="45%">
</p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/cff0c563-88cd-467d-bded-68344dcbeb1c" width="45%">
  <img src="https://github.com/user-attachments/assets/020c3634-92c6-4691-a31c-f642f4c1b265" width="45%">
</p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/b20f140f-8a7d-4424-82e6-e450384bc5f7" width="45%">
  <img src="https://github.com/user-attachments/assets/951684bd-62d5-40df-be46-058d41661e36" width="45%">
</p>




> **TÃ¡c giáº£**: NhÃ³m há»c sinh TrÆ°á»ng THPT Hoa LÆ° A, Ninh BÃ¬nh (tÃ´i: Pháº¡m Thanh TÃ¹ng - HoÃ ng Tiáº¿n Äáº¡t)

>* **Pháº¡m Thanh TÃ¹ng** â€“ Phá»¥ trÃ¡ch chÃ­nh pháº§n **láº­p trÃ¬nh, xá»­ lÃ½ áº£nh, thuáº­t toÃ¡n tÃ­nh tá»‘c Ä‘á»™ vÃ  Ä‘iá»u khiá»ƒn há»‡ thá»‘ng Arduino**.
>* **HoÃ ng Tiáº¿n Äáº¡t** â€“ Phá»¥ trÃ¡ch pháº§n **thiáº¿t káº¿, láº¯p rÃ¡p pháº§n cá»©ng, lá»±a chá»n linh kiá»‡n vÃ  triá»ƒn khai thá»±c táº¿**.

Cáº£ hai thÃ nh viÃªn cÃ¹ng tham gia nghiÃªn cá»©u, xÃ¢y dá»±ng Ã½ tÆ°á»Ÿng vÃ  thá»­ nghiá»‡m há»‡ thá»‘ng.

> **Tháº§y hÆ°á»¡ng dáº«n**: Nguyá»…n Máº¡nh TÃº.
>
> **Thá»i gian thá»±c hiá»‡n**: 08/2021 â€“ 03/2022
> 
> **Cuá»™c thi**: Khoa há»c ká»¹ thuáº­t cáº¥p quá»‘c gia, nÄƒm há»c 2021 â€“ 2022

## Ghi chÃº & Lá»i cáº£m Æ¡n

ChÃºng tÃ´i cÅ©ng xin gá»­i lá»i cáº£m Æ¡n chÃ¢n thÃ nh Ä‘áº¿n cá»™ng Ä‘á»“ng Arduino, Python vÃ  xá»­ lÃ½ áº£nh â€“ nhá»¯ng ngÆ°á»i Ä‘Ã£ chia sáº» vÃ´ sá»‘ tÃ i liá»‡u, hÆ°á»›ng dáº«n, bÃ i viáº¿t, video vÃ  kinh nghiá»‡m thá»±c tiá»…n. Sá»± cá»Ÿi má»Ÿ vÃ  sáºµn sÃ ng chia sáº» kiáº¿n thá»©c cá»§a cá»™ng Ä‘á»“ng lÃ  ná»n táº£ng giÃºp nhá»¯ng ngÆ°á»i tráº» nhÆ° chÃºng tÃ´i tiáº¿p cáº­n vÃ  hiá»‡n thá»±c hÃ³a cÃ¡c Ã½ tÆ°á»Ÿng cÃ´ng nghá»‡.

> **âš ï¸âš ï¸**
> * Dá»± Ã¡n nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n **vá»›i má»¥c Ä‘Ã­ch há»c táº­p, nghiÃªn cá»©u khoa há»c vÃ  Ä‘Ã³ng gÃ³p vÃ o cÃ¡c giáº£i phÃ¡p á»©ng dá»¥ng thá»±c tiá»…n**.
> * **KhÃ´ng sá»­ dá»¥ng cho má»¥c Ä‘Ã­ch thÆ°Æ¡ng máº¡i** dÆ°á»›i báº¥t ká»³ hÃ¬nh thá»©c nÃ o.
> * Má»™t sá»‘ Ä‘oáº¡n mÃ£, thÆ° viá»‡n vÃ  Ã½ tÆ°á»Ÿng thuáº­t toÃ¡n trong dá»± Ã¡n cÃ³ tham kháº£o tá»« cá»™ng Ä‘á»“ng, chÃºng tÃ´i Ä‘Ã£ cÃ³ sá»± káº¿ thá»«a vÃ  phÃ¡t triá»ƒn tá»« cÃ¡c nguá»“n má»Ÿ vÃ  cÃ¡ nhÃ¢n cÃ³ cÃ¹ng Ä‘am mÃª.

Má»™t láº§n ná»¯a, xin chÃ¢n thÃ nh cáº£m Æ¡n cá»™ng Ä‘á»“ng ká»¹ thuáº­t Ä‘Ã£ chia sáº» tri thá»©c quÃ½ bÃ¡u.

